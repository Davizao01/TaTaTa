<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo Dragon Ball</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #282c34;
            color: white;
            text-align: center;
        }
        #map {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            position: relative;
            width: 400px; /* Tamanho fixo do mapa */
            height: 400px; /* Tamanho fixo do mapa */
            margin: 20px auto;
            border: 1px solid #fff;
            overflow: hidden;
        }
        .block {
            width: 20px;
            height: 20px;
            display: inline-block;
            box-sizing: border-box;
        }
        .player {
            background-color: #00ff00; /* Cor do jogador */
        }
        .enemy {
            background-color: #ff0000; /* Cor do inimigo */
        }
        .item {
            background-color: #ffff00; /* Cor do item */
        }
        #arena {
            display: none;
            margin: 20px;
        }
        #menu, #store, #skills {
            display: none;
        }
        #status {
            margin: 10px;
        }
    </style>
</head>
<body>
    <h1>Jogo Dragon Ball</h1>
    <div id="status"></div>
    <div id="menu">
        <input type="text" id="playerName" placeholder="Nome do Jogador">
        <button onclick="iniciarJogo()">Iniciar Jogo</button>
        <button onclick="mostrarInstrucoes()">Instruções</button>
    </div>

    <div id="map"></div>

    <div id="arena">
        <h2>Arena PvP</h2>
        <button onclick="startPvP()">Começar Batalha</button>
        <button onclick="voltarMenu()">Voltar ao Menu</button>
    </div>

    <div id="store">
        <h2>Loja</h2>
        <div id="items"></div>
        <button onclick="voltarMenu()">Voltar ao Menu</button>
    </div>

    <script>
        let playerName = '';
        let moedas = 0;
        let playerLife = 10;
        let playerX = 10; // Posição inicial do jogador no mapa
        let playerY = 10; // Posição inicial do jogador no mapa
        const tamanhoMapa = 20; // Tamanho do mapa (20x20)
        let mapArray = [];

        const itemsLoja = [
            { nome: 'Espada', custo: 5 },
            { nome: 'Escudo', custo: 3 },
            { nome: 'Semente do Deus', custo: 2 }
        ];

        function iniciarJogo() {
            playerName = document.getElementById('playerName').value;
            if (playerName) {
                document.getElementById('menu').style.display = 'none';
                gerarMapa();
                atualizarStatus();
            } else {
                alert('Por favor, insira um nome.');
            }
        }

        function gerarMapa() {
            const mapDiv = document.getElementById('map');
            mapDiv.innerHTML = ''; // Limpa o mapa anterior
            mapArray = Array.from({ length: tamanhoMapa }, () => Array(tamanhoMapa).fill('')); // Inicializa o mapa
            for (let i = 0; i < tamanhoMapa; i++) {
                for (let j = 0; j < tamanhoMapa; j++) {
                    const block = document.createElement('div');
                    block.classList.add('block');
                    if (i === playerY && j === playerX) {
                        block.classList.add('player');
                        mapArray[i][j] = 'player'; // Atualiza a posição do jogador
                    } else if (Math.random() < 0.1) {
                        block.classList.add('enemy');
                        mapArray[i][j] = 'enemy'; // Adiciona um inimigo
                    } else if (Math.random() < 0.05) {
                        block.classList.add('item');
                        mapArray[i][j] = 'item'; // Adiciona um item
                    }
                    mapDiv.appendChild(block);
                }
            }
        }

        function atualizarStatus() {
            document.getElementById('status').innerText = `Jogador: ${playerName} | Vida: ${playerLife} | Moedas: ${moedas}`;
        }

        document.addEventListener('keydown', (event) => {
            switch (event.key) {
                case 'ArrowUp':
                    moverJogador(0, -1);
                    break;
                case 'ArrowDown':
                    moverJogador(0, 1);
                    break;
                case 'ArrowLeft':
                    moverJogador(-1, 0);
                    break;
                case 'ArrowRight':
                    moverJogador(1, 0);
                    break;
                case 'i': // Mostrar loja
                    irParaLoja();
                    break;
                case 'p': // Ir para a arena
                    irParaArena();
                    break;
            }
        });

        function moverJogador(deltaX, deltaY) {
            const novaX = playerX + deltaX;
            const novaY = playerY + deltaY;

            // Verifica limites do mapa
            if (novaX >= 0 && novaX < tamanhoMapa && novaY >= 0 && novaY < tamanhoMapa) {
                // Atualiza a posição no mapa
                mapArray[playerY][playerX] = '';
                playerX = novaX;
                playerY = novaY;
                mapArray[playerY][playerX] = 'player';
                gerarMapa(); // Atualiza o mapa
                atualizarStatus(); // Atualiza o status
                verificarItem(); // Verifica se o jogador encontrou um item
            }
        }

        function verificarItem() {
            if (mapArray[playerY][playerX] === 'item') {
                moedas++;
                alert('Você encontrou um item! Moedas +1');
                atualizarStatus();
            }
        }

        function startPvP() {
            alert('Batalha PvP começando!'); // Simulação da batalha PvP
            // Adicione a lógica de batalha aqui
        }

        function irParaArena() {
            document.getElementById('arena').style.display = 'block';
            document.getElementById('map').style.display = 'none';
        }

        function irParaLoja() {
            document.getElementById('store').style.display = 'block';
            const itemsContainer = document.getElementById('items');
            itemsContainer.innerHTML = '';
            itemsLoja.forEach(item => {
                itemsContainer.innerHTML += `<div class="item">${item.nome} - ${item.custo} moedas <button onclick="comprarItem('${item.nome}', ${item.custo})">Comprar</button></div>`;
            });
            document.getElementById('map').style.display = 'none';
        }

        function comprarItem(nome, custo) {
            if (moedas >= custo) {
                moedas -= custo;
                alert(`Você comprou ${nome}!`);
                atualizarStatus();
            } else {
                alert('Moedas insuficientes!');
            }
        }

        function voltarMenu() {
            document.getElementById('arena').style.display = 'none';
            document.getElementById('store').style.display = 'none';
            document.getElementById('map').style.display = 'block';
            document.getElementById('menu').style.display = 'block';
        }

        function mostrarInstrucoes() {
            alert('Instruções:\n1. Use as setas do teclado para se mover.\n2. Pressione "I" para acessar a loja.\n3. Pressione "P" para ir para a arena PvP.\n4. Colete itens e ganhe moedas ao explorar.');
        }
    </script>
</body>
</html>
